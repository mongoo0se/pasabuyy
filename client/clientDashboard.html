<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pa-Buy Bes! Client Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root { font-family: 'Inter', sans-serif; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        /* Smooth Tab Transitions */
        .content-section {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        .content-section.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Glassmorphism for Modal */
        .modal-bg { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); }
    </style>
</head>
<body class="bg-gray-50 text-slate-900 flex h-screen overflow-hidden">

    <aside class="w-64 bg-white border-r border-gray-200 flex-shrink-0 flex flex-col z-20">
        <div class="p-6">
            <div class="flex items-center gap-3 text-blue-600">
                <div class="bg-blue-600 text-white p-2 rounded-lg">
                    <i data-lucide="shopping-bag" class="w-5 h-5"></i>
                </div>
                <span class="text-xl font-bold tracking-tight text-slate-800">Pa-Buy Bes!</span>
            </div>
        </div>

        <nav class="flex-1 px-4 space-y-1">
            <button onclick="switchTab('dashboard')" class="nav-btn active w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-200 text-blue-600 bg-blue-50 font-semibold">
                <i data-lucide="home" class="w-5 h-5"></i> Dashboard
            </button>
          <button onclick="switchTab('stores')" class="nav-btn w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-200 text-slate-600 hover:bg-gray-100">
                <i data-lucide="store" class="w-5 h-5"></i> Stores
            </button>
            <button onclick="switchTab('orders')" class="nav-btn w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-200 text-slate-600 hover:bg-gray-100">
                <i data-lucide="shopping-cart" class="w-5 h-5"></i> Orders
            </button>
           <button onclick="switchTab('messages')" class="nav-btn w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-200 text-slate-600 hover:bg-gray-100">
                <i data-lucide="message-circle" class="w-5 h-5"></i> Messages
            </button>
        </nav>

        <div class="p-4 border-t border-gray-100">
            <button onclick="logout()" class="w-full flex items-center gap-3 p-3 rounded-xl text-red-500 hover:bg-red-50 transition-colors">
                <i data-lucide="log-out" class="w-5 h-5"></i> Logout
            </button>
        </div>
    </aside>

    <div class="flex-1 flex flex-col min-w-0 overflow-hidden">
        
        <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8">
            <h2 id="page-title" class="text-lg font-semibold text-slate-800">Dashboard Overview</h2>
            <div class="flex items-center gap-5">
                <div class="relative">
                    <button onclick="toggleNotifications()">
                        <i data-lucide="bell" class="w-5 h-5 text-slate-400"></i>
                        <span class="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border-2 border-white"></span>
                    </button>

                    <!-- Notification Dropdown -->
                    <div id="notificationBox"
                        class="hidden absolute right-0 mt-4 w-80 bg-white rounded-2xl shadow-xl border z-50">
                        <div class="p-4 border-b font-bold text-slate-800">
                            Notifications
                        </div>

                        <div class="max-h-72 overflow-y-auto divide-y">
                            <div class="p-4 hover:bg-slate-50">
                                <p class="text-sm font-semibold">Order Delivered</p>
                                <p class="text-xs text-slate-500">Your order #ORD-1023 ‚Ä¢ 2 mins ago</p>
                            </div>
                            <div class="p-4 hover:bg-slate-50">
                                <p class="text-sm font-semibold text-green-600">New Store Available</p>
                                <p class="text-xs text-slate-500">Check out the latest restaurants</p>
                            </div>
                            <div class="p-4 hover:bg-slate-50">
                                <p class="text-sm font-semibold">Special Promo</p>
                                <p class="text-xs text-slate-500">50% off on selected items today</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="relative">
                    <button onclick="toggleUserMenu()" class="flex items-center gap-3 pl-5 border-l">
                        <img src="https://ui-avatars.com/api/?name=Customer&background=0D8ABC&color=fff"
                            class="w-8 h-8 rounded-full shadow-sm">
                        <span class="text-sm font-medium text-slate-700">Customer</span>
                        <i data-lucide="chevron-down" class="w-4 h-4 text-slate-400"></i>
                    </button>

                    <!-- User Dropdown -->
                    <div id="userMenu"
                        class="hidden absolute right-0 mt-4 w-56 bg-white rounded-2xl shadow-xl border z-50">
                        <button class="w-full flex items-center gap-3 p-4 hover:bg-slate-50">
                            <i data-lucide="user" class="w-4 h-4"></i> My Profile
                        </button>
                        <button onclick="switchTab('account-settings')" class="w-full flex items-center gap-3 p-4 hover:bg-slate-50">
                            <i data-lucide="settings" class="w-4 h-4"></i> Account Settings
                        </button>
                        <button onclick="logout()"
                            class="w-full flex items-center gap-3 p-4 text-red-500 hover:bg-red-50">
                            <i data-lucide="log-out" class="w-4 h-4"></i> Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="flex-1 overflow-y-auto p-8">
            
            <section id="dashboard-section" class="content-section active space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-slate-500 text-sm font-medium">Total Orders</p>
                        <h3 class="text-2xl font-bold mt-2">12</h3>
                        <span class="text-green-500 text-xs font-bold mt-2 flex items-center gap-1">
                            <i data-lucide="arrow-up-right" class="w-3 h-3"></i> +2 this month
                        </span>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-slate-500 text-sm font-medium">Pending Orders</p>
                        <h3 class="text-2xl font-bold mt-2">2</h3>
                        <span class="text-blue-500 text-xs font-bold mt-2 italic">Est. arrival in 30 mins</span>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-slate-500 text-sm font-medium">Total Spent</p>
                        <h3 class="text-2xl font-bold mt-2">$540.00</h3>
                        <span class="text-slate-400 text-xs mt-2">Across 12 orders</span>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <p class="text-slate-500 text-sm font-medium">Favorite Stores</p>
                        <h3 class="text-2xl font-bold mt-2">5</h3>
                        <span class="text-slate-400 text-xs mt-2">Saved for quick access</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-6">Order History</h4>
                        <canvas id="orderChart" height="140"></canvas>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-6">Recent Activity</h4>
                        <div class="space-y-6">
                            <div class="flex gap-4">
                                <div class="w-2 h-2 mt-2 rounded-full bg-green-500"></div>
                                <div>
                                    <p class="text-sm font-medium">Order #1023 delivered</p>
                                    <p class="text-xs text-slate-400">2 hours ago</p>
                                </div>
                            </div>
                            <div class="flex gap-4">
                                <div class="w-2 h-2 mt-2 rounded-full bg-blue-500"></div>
                                <div>
                                    <p class="text-sm font-medium">New store nearby</p>
                                    <p class="text-xs text-slate-400">1 day ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="stores-section" class="content-section space-y-6">
                <!-- Search Bar -->
                <div class="flex gap-3">
                    <input type="text" id="searchInput" placeholder="Search stores..."
                        class="flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-blue-100 outline-none" onkeyup="searchStores(this.value)">
                </div>

                <!-- Navigation Filter Bar -->
                <div class="bg-white rounded-2xl border border-gray-100 shadow-sm">
                    <div class="flex gap-0">
                        <button onclick="filterStores('all')" class="filter-btn flex-1 px-6 py-4 text-center bg-blue-600 text-white font-semibold rounded-tl-2xl rounded-bl-2xl hover:bg-blue-700 transition-all border-r border-blue-500" data-category="all">All Stores</button>
                        <button onclick="filterStores('favorites')" class="filter-btn flex-1 px-6 py-4 text-center bg-slate-100 text-slate-700 font-semibold rounded-tr-2xl rounded-br-2xl hover:bg-slate-200 transition-all" data-category="favorites">‚≠ê Favorites</button>
                    </div>
                </div>

                <!-- Store Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="storeGrid">
                    <!-- Store Card 1 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="1">
                        <div class="relative h-40 bg-gradient-to-br from-orange-400 to-orange-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400&h=300&fit=crop" alt="Golden Taste" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="1" onclick="toggleFavorite(event, 'Golden Taste', 1)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Golden Taste', 'Fast Food & Burgers', 4.8, '20-30 mins', '‚Ç±50', '‚Ç±200')">
                            <h3 class="text-lg font-bold text-gray-900">Golden Taste</h3>
                            <p class="text-sm text-gray-600 mt-1">Delicious burgers, fried chicken, and crispy fries prepared fresh daily.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.8</span>
                                <span class="text-gray-500">Delivery: ‚Ç±50</span>
                            </div>
                        </div>
                    </div>

                    <!-- Store Card 2 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="2">
                        <div class="relative h-40 bg-gradient-to-br from-green-400 to-green-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop" alt="Fresh Greens" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="2" onclick="toggleFavorite(event, 'Fresh Greens', 2)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Fresh Greens', 'Salads & Healthy Bowls', 4.6, '15-25 mins', '‚Ç±40', '‚Ç±150')">
                            <h3 class="text-lg font-bold text-gray-900">Fresh Greens</h3>
                            <p class="text-sm text-gray-600 mt-1">Fresh organic salads, acai bowls, and nutritious meal prep options.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.6</span>
                                <span class="text-gray-500">Delivery: ‚Ç±40</span>
                            </div>
                        </div>
                    </div>

                    <!-- Store Card 3 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="3">
                        <div class="relative h-40 bg-gradient-to-br from-red-400 to-red-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1555939594-58d7cb561241?w=400&h=300&fit=crop" alt="Spicy Wok" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="3" onclick="toggleFavorite(event, 'Spicy Wok', 3)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Spicy Wok', 'Asian & Chinese Cuisine', 4.7, '25-35 mins', '‚Ç±60', '‚Ç±250')">
                            <h3 class="text-lg font-bold text-gray-900">Spicy Wok</h3>
                            <p class="text-sm text-gray-600 mt-1">Authentic Asian dishes, stir-fries, and noodles with bold flavors.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.7</span>
                                <span class="text-gray-500">Delivery: ‚Ç±60</span>
                            </div>
                        </div>
                    </div>

                    <!-- Store Card 4 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="4">
                        <div class="relative h-40 bg-gradient-to-br from-purple-400 to-purple-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&h=300&fit=crop" alt="Coffee Corner" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="4" onclick="toggleFavorite(event, 'Coffee Corner', 4)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Coffee Corner', 'Caf√© & Pastries', 4.9, '10-15 mins', '‚Ç±30', '‚Ç±100')">
                            <h3 class="text-lg font-bold text-gray-900">Coffee Corner</h3>
                            <p class="text-sm text-gray-600 mt-1">Specialty coffee, artisanal pastries, and cozy breakfast favorites.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.9</span>
                                <span class="text-gray-500">Delivery: ‚Ç±30</span>
                            </div>
                        </div>
                    </div>

                    <!-- Store Card 5 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="5">
                        <div class="relative h-40 bg-gradient-to-br from-pink-400 to-pink-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1565958011504-4b852e45b58c?w=400&h=300&fit=crop" alt="Sweet Bites" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="5" onclick="toggleFavorite(event, 'Sweet Bites', 5)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Sweet Bites', 'Desserts & Confectionery', 4.8, '20-25 mins', '‚Ç±45', '‚Ç±180')">
                            <h3 class="text-lg font-bold text-gray-900">Sweet Bites</h3>
                            <p class="text-sm text-gray-600 mt-1">Delectable desserts, cakes, ice cream, and sweet treats for any occasion.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.8</span>
                                <span class="text-gray-500">Delivery: ‚Ç±45</span>
                            </div>
                        </div>
                    </div>

                    <!-- Store Card 6 -->
                    <div class="store-card bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden cursor-pointer" data-category="all" data-store-id="6">
                        <div class="relative h-40 bg-gradient-to-br from-blue-400 to-blue-500 overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1586985289688-cacf884ca6a1?w=400&h=300&fit=crop" alt="Pasta Paradise" class="w-full h-full object-cover">
                            <button class="favorite-btn absolute top-3 right-3 bg-white rounded-full p-2 hover:bg-gray-100 transition-all shadow-lg" data-store-id="6" onclick="toggleFavorite(event, 'Pasta Paradise', 6)">
                                <svg class="w-6 h-6 text-gray-400 favorite-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                            </button>
                        </div>
                        <div class="p-4" onclick="openStoreModal('Pasta Paradise', 'Italian Cuisine', 4.7, '30-40 mins', '‚Ç±70', '‚Ç±300')">
                            <h3 class="text-lg font-bold text-gray-900">Pasta Paradise</h3>
                            <p class="text-sm text-gray-600 mt-1">Authentic Italian pasta, risotto, and traditional dishes made with fresh ingredients.</p>
                            <div class="mt-3 flex justify-between items-center text-sm">
                                <span class="text-yellow-500 font-semibold">‚≠ê 4.7</span>
                                <span class="text-gray-500">Delivery: ‚Ç±70</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="orders-section" class="content-section space-y-6">

                <!-- Header -->
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold">My Orders</h3>
                    <div class="flex gap-3">
                        <button onclick="switchTab('stores')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold text-sm transition-colors">Continue Shopping</button>
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-white p-5 rounded-2xl border shadow-sm">
                        <p class="text-sm text-slate-500">Total Orders</p>
                        <h3 class="text-2xl font-bold mt-1">12</h3>
                    </div>
                    <div class="bg-white p-5 rounded-2xl border shadow-sm">
                        <p class="text-sm text-slate-500">In Progress</p>
                        <h3 class="text-2xl font-bold text-blue-500 mt-1">2</h3>
                    </div>
                    <div class="bg-white p-5 rounded-2xl border shadow-sm">
                        <p class="text-sm text-slate-500">Completed</p>
                        <h3 class="text-2xl font-bold text-green-600 mt-1">10</h3>
                    </div>
                    <div class="bg-white p-5 rounded-2xl border shadow-sm">
                        <p class="text-sm text-slate-500">Cancelled</p>
                        <h3 class="text-2xl font-bold text-red-500 mt-1">0</h3>
                    </div>
                </div>

                <!-- Orders Detail Cards -->
                <div class="space-y-4">
                    <!-- Order Card 1 -->
                    <div class="bg-white rounded-2xl border shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <button onclick="switchStore('Bes Burger House')" class="text-xl font-bold text-blue-600 hover:text-blue-700 hover:underline transition">Bes Burger House</button>
                                    <p class="text-xs text-slate-500 mt-2">Order #ORD-1023 ‚Ä¢ Feb 7, 2026</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xl font-bold text-blue-600">$45.50</p>
                                </div>
                            </div>
                            <button onclick="openDeliveryTimeline('Order Placed', 'Delivered', 'ORD-1023')" class="w-full -mx-6 px-6 py-3 bg-green-100 text-green-700 font-bold text-sm hover:bg-green-200 transition cursor-pointer">‚úì Delivered - View Journey</button>
                            <div class="border-t pt-4 mt-4">
                                <h5 class="font-semibold text-sm mb-3">Order Items</h5>
                                <div class="space-y-3">
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Burger Combo', '$28.99', 1, 'Delicious burger combo with fresh ingredients')">
                                        <img src=\"https://via.placeholder.com/80?text=Burger\" alt=\"Burger Combo\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Burger Combo</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$28.99</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Fries', '$8.50', 2, 'Crispy golden fries')">
                                        <img src=\"https://via.placeholder.com/80?text=Fries\" alt=\"Fries\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Fries</p>
                                            <p class="text-xs text-slate-500\">Quantity: 2</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$8.50</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Action buttons removed per request -->
                        </div>
                    </div>

                    <!-- Order Card 2 -->
                    <div class="bg-white rounded-2xl border shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <button onclick="switchStore('Pizza Palace')" class="text-xl font-bold text-blue-600 hover:text-blue-700 hover:underline transition">Pizza Palace</button>
                                    <p class="text-xs text-slate-500 mt-2">Order #ORD-1024 ‚Ä¢ Feb 13, 2026</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xl font-bold text-blue-600">$52.00</p>
                                </div>
                            </div>
                            <button onclick="openDeliveryTimeline('Order Placed', 'Pending', 'ORD-1024')" class="w-full -mx-6 px-6 py-3 bg-yellow-100 text-yellow-700 font-bold text-sm hover:bg-yellow-200 transition cursor-pointer">‚è≥ Pending - View Journey</button>
                            <div class="border-t pt-4 mt-4">
                                <h5 class="font-semibold text-sm mb-3">Order Items</h5>
                                <div class="space-y-3">
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Large Pepperoni Pizza', '$35.00', 1, 'Delicious pepperoni pizza with fresh ingredients')">
                                        <img src=\"https://via.placeholder.com/80?text=Pizza\" alt=\"Large Pizza\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Large Pepperoni Pizza</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$35.00</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Soft Drink (2L)', '$5.00', 1, 'Refreshing soft drink')">
                                        <img src=\"https://via.placeholder.com/80?text=Drink\" alt=\"Drink\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Soft Drink (2L)</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$5.00</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t mt-4 pt-4">
                                <button class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 rounded-lg transition text-sm">Pay Now</button>
                            </div>
                        </div>
                    </div>

                    <!-- Order Card 3 -->
                    <div class="bg-white rounded-2xl border shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <button onclick="switchStore('Cafe Blend')" class="text-xl font-bold text-blue-600 hover:text-blue-700 hover:underline transition">Cafe Blend</button>
                                    <p class="text-xs text-slate-500 mt-2">Order #ORD-1025 ‚Ä¢ Feb 12, 2026</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xl font-bold text-blue-600">$28.75</p>
                                </div>
                            </div>
                            <button onclick="openDeliveryTimeline('Order Placed', 'In Delivery', 'ORD-1025')" class="w-full -mx-6 px-6 py-3 bg-blue-100 text-blue-700 font-bold text-sm hover:bg-blue-200 transition cursor-pointer">üì¶ In Delivery - View Journey</button>
                            <div class="border-t pt-4 mt-4">
                                <h5 class="font-semibold text-sm mb-3">Order Items</h5>
                                <div class="space-y-3">
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Cappuccino (Large)', '$16.00', 2, 'Premium cappuccino made with freshly ground coffee beans')">
                                        <img src=\"https://via.placeholder.com/80?text=Coffee\" alt=\"Coffee\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Cappuccino (Large)</p>
                                            <p class="text-xs text-slate-500\">Quantity: 2</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$16.00</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-3 cursor-pointer hover:opacity-80 transition" onclick="openProductDetail('Croissant', '$7.00', 2, 'Fresh butter croissant, baked fresh daily')">
                                        <img src=\"https://via.placeholder.com/80?text=Pastry\" alt=\"Pastry\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Croissant</p>
                                            <p class="text-xs text-slate-500\">Quantity: 2</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$7.00</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t mt-4 pt-4">
                                <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg transition text-sm">Track Order</button>
                            </div>
                        </div>
                    </div>

                    <!-- Order Card 4 -->
                    <div class="bg-white rounded-2xl border shadow-sm overflow-hidden hover:shadow-md transition-shadow">
                        <div class="p-6">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h4 class="font-bold text-lg">#ORD-1026</h4>
                                    <p class="text-sm text-slate-500">Bakery Fresh</p>
                                    <p class="text-xs text-slate-400 mt-1">Feb 11, 2026</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xl font-bold text-blue-600">$35.25</p>
                                    <div class="flex gap-2 mt-2 justify-end">
                                        <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full">
                                            Paid
                                        </span>
                                        <span class="px-3 py-1 bg-orange-100 text-orange-700 text-xs font-bold rounded-full">
                                            To Be Delivered
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t pt-4">
                                <h5 class="font-semibold text-sm mb-3">Order Items</h5>
                                <div class="space-y-3">
                                    <div class="flex gap-3">
                                        <img src=\"https://via.placeholder.com/80?text=Bread\" alt=\"Bread\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Whole Wheat Bread</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$6.50</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-3">
                                        <img src=\"https://via.placeholder.com/80?text=Cake\" alt=\"Cake\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Chocolate Cake</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$20.00</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-3">
                                        <img src=\"https://via.placeholder.com/80?text=Donuts\" alt=\"Donuts\" class=\"w-20 h-20 rounded-lg object-cover\">
                                        <div class="flex-1">
                                            <p class="font-semibold text-sm\">Glazed Donuts (Box)</p>
                                            <p class="text-xs text-slate-500\">Quantity: 1</p>
                                            <p class="text-sm font-bold text-blue-600 mt-1\">$8.75</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t mt-4 pt-4 flex gap-2">
                                <button class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg transition text-sm\">Track Order</button>
                                <button class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 rounded-lg transition text-sm\">Reorder</button>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section id="messages-section" class="content-section space-y-6">

                <!-- Header -->
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold">Messages</h3>
                    <div class="flex gap-3">
                        <input id="globalConversationSearch" type="text" placeholder="Search conversations..."
                            class="bg-slate-50 border border-slate-200 rounded-xl px-4 py-2 text-sm focus:ring-2 focus:ring-blue-100 outline-none" onkeyup="searchConversations(this.value)">
                    </div>
                </div>

                <!-- Chat UI: Left = conversations, Right = messages -->
                <div class="bg-white rounded-2xl border shadow-sm overflow-hidden">
                    <div class="flex h-96">
                        <!-- Conversations List -->
                        <div class="w-1/3 border-r p-4 flex flex-col">
                            <input id="conversationSearch" type="text" placeholder="Search..." class="bg-slate-50 border border-slate-200 rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-blue-100 outline-none" onkeyup="searchConversations(this.value)">
                            <ul id="convoList" class="mt-3 space-y-2 overflow-y-auto">
                                <!-- conversations injected here -->
                            </ul>
                        </div>

                        <!-- Chat Window -->
                        <div class="flex-1 p-4 flex flex-col">
                            <div id="chatHeader" class="border-b pb-3 mb-3">
                                <h4 id="chatWith" class="font-semibold text-lg text-slate-800">Select a conversation</h4>
                            </div>
                            <div id="chatWindow" class="flex-1 overflow-y-auto p-3 rounded-lg bg-slate-50">
                                <p class="text-sm text-slate-400">Choose a conversation from the left to view messages.</p>
                            </div>

                            <div class="mt-3">
                                <div class="flex gap-2">
                                    <input id="messageInput" type="text" placeholder="Type a message..." class="flex-1 bg-white border rounded-xl px-4 py-2" onkeydown="if(event.key==='Enter') sendMessage()">
                                    <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section id="profile-section" class="content-section space-y-6">

                <!-- Header -->
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold">My Profile</h3>
                    <button onclick="switchTab('profile')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl font-semibold text-sm transition-colors">Full Profile</button>
                </div>

                <!-- Profile Info -->
                <div class="bg-white rounded-2xl border shadow-sm p-6 space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-semibold text-slate-700">First Name</label>
                            <input type="text" value="Juan"
                                class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                        </div>
                        <div>
                            <label class="text-sm font-semibold text-slate-700">Last Name</label>
                            <input type="text" value="Dela Cruz"
                                class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                        </div>
                    </div>

                    <div>
                        <label class="text-sm font-semibold text-slate-700">Email</label>
                        <input type="email" value="juan@email.com"
                            class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                    </div>

                    <div>
                        <label class="text-sm font-semibold text-slate-700">Phone</label>
                        <input type="text" value="+63 912 345 6789"
                            class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                    </div>

                    <div>
                        <label class="text-sm font-semibold text-slate-700">Address</label>
                        <textarea rows="3" class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">123 Main Street, City, Province 12345</textarea>
                    </div>

                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl">
                        Update Profile
                    </button>
                </div>

            </section>

            <section id="account-settings-section" class="content-section space-y-6">

                <!-- Header -->
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold">Account Settings</h3>
                </div>

                <!-- Account Security -->
                <div class="bg-white rounded-2xl border shadow-sm p-6 space-y-6">
                    <div>
                        <h4 class="font-bold text-lg mb-4">Security Settings</h4>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-semibold text-slate-700">Current Password</label>
                                <input type="password" placeholder="Enter current password"
                                    class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-slate-700">New Password</label>
                                <input type="password" placeholder="Enter new password"
                                    class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-slate-700">Confirm New Password</label>
                                <input type="password" placeholder="Confirm new password"
                                    class="w-full mt-1 bg-slate-50 border rounded-xl px-4 py-3">
                            </div>

                            <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors">
                                Update Password
                            </button>
                        </div>
                    </div>

                    <div class="border-t pt-6">
                        <h4 class="font-bold text-lg mb-4">Two-Factor Authentication</h4>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-semibold">Enable 2FA for added security</p>
                                <p class="text-xs text-slate-500 mt-1">Protect your account with two-factor authentication</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>

                    <div class="border-t pt-6">
                        <h4 class="font-bold text-lg mb-4">Active Sessions</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-slate-50 rounded-lg">
                                <div>
                                    <p class="font-semibold text-sm">Current Device</p>
                                    <p class="text-xs text-slate-500">Chrome on Windows ‚Ä¢ Last active now</p>
                                </div>
                                <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full">Active</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-slate-50 rounded-lg">
                                <div>
                                    <p class="font-semibold text-sm">Mobile Device</p>
                                    <p class="text-xs text-slate-500">Safari on iPhone ‚Ä¢ Last active 2 hours ago</p>
                                </div>
                                <button class="text-red-600 hover:text-red-700 text-xs font-bold">Logout</button>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

        </main>
    </div>

    <div id="orderModal" class="fixed inset-0 modal-bg z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-3xl w-full max-w-lg shadow-2xl">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-xl font-bold">Order Details</h3>
                <button onclick="closeOrderModal()" class="p-2 hover:bg-gray-100 rounded-full">
                    <i data-lucide="x"></i>
                </button>
            </div>

            <div class="p-6 space-y-4 text-sm">
                <p><strong>Order ID:</strong> <span id="oId"></span></p>
                <p><strong>Store:</strong> <span id="oStore"></span></p>
                <p><strong>Total:</strong> <span id="oTotal"></span></p>
                <p><strong>Order Date:</strong> <span id="oDate"></span></p>
                
                <div class="pt-4 border-t">
                    <h4 class="font-semibold mb-3">Status Information</h4>
                    <div class="space-y-3">
                        <div>
                            <p class="text-xs text-slate-500 uppercase font-bold">Payment Status</p>
                            <span id="oStatus" class="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full inline-block"></span>
                        </div>
                        <div>
                            <p class="text-xs text-slate-500 uppercase font-bold">Delivery Status</p>
                            <span id="oDeliveryStatus" class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full inline-block"></span>
                        </div>
                    </div>
                </div>

                <div class="pt-4 border-t">
                    <h4 class="font-semibold mb-2">Items</h4>
                    <ul class="list-disc list-inside text-slate-600">
                        <li>Burger Combo √ó1</li>
                        <li>Fries √ó2</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // 1. Tab Switching System
        function switchTab(tabId) {
            // Update Title
            const titles = {
                'dashboard': 'Dashboard Overview',
                'stores': 'Favorite Stores',
                'orders': 'My Orders',
                'messages': 'Messages',
                'profile': 'My Profile',
                'account-settings': 'Account Settings'
            };
            document.getElementById('page-title').innerText = titles[tabId];

            // Toggle Active Sections
            document.querySelectorAll('.content-section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(`${tabId}-section`).classList.add('active');

            // Update Sidebar UI
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-blue-600', 'bg-blue-50', 'font-semibold');
                btn.classList.add('text-slate-600');
            });
            event.currentTarget.classList.add('text-blue-600', 'bg-blue-50', 'font-semibold');
        }

        // 2. Order Chart Initialization
        const ctx = document.getElementById('orderChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],
                datasets: [{
                    label: 'Orders',
                    data: [2, 3, 1, 4, 2],
                    borderColor: '#2563eb',
                    borderWidth: 3,
                    tension: 0.4,
                    fill: true,
                    backgroundColor: (context) => {
                        const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                        gradient.addColorStop(0, 'rgba(37, 99, 235, 0.2)');
                        gradient.addColorStop(1, 'rgba(37, 99, 235, 0)');
                        return gradient;
                    },
                    pointBackgroundColor: '#fff',
                    pointBorderColor: '#2563eb',
                    pointBorderWidth: 2,
                    pointRadius: 4
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { grid: { color: '#f1f5f9' }, ticks: { font: { family: 'Inter' } } },
                    x: { grid: { display: false } }
                }
            }
        });

        // NOTIFICATION DROPDOWN
        function toggleNotifications() {
            document.getElementById('notificationBox').classList.toggle('hidden');
        }

        // Close notification when clicking outside
        document.addEventListener('click', (e) => {
            const notifBox = document.getElementById('notificationBox');
            const notifButton = e.target.closest('[onclick*="toggleNotifications"]');
            if (!notifBox.contains(e.target) && !notifButton) {
                notifBox.classList.add('hidden');
            }
        });

        // USER MENU DROPDOWN
        function toggleUserMenu() {
            document.getElementById('userMenu').classList.toggle('hidden');
        }

        // Close user menu when clicking outside
        document.addEventListener('click', (e) => {
            const userMenu = document.getElementById('userMenu');
            const userButton = e.target.closest('[onclick*="toggleUserMenu"]');
            if (!userMenu.contains(e.target) && !userButton) {
                userMenu.classList.add('hidden');
            }
        });

        // ORDER MODAL
        const orderModal = document.getElementById('orderModal');

        function openOrderModal(id, store, total, date, status, deliveryStatus) {
            document.getElementById('oId').innerText = id;
            document.getElementById('oStore').innerText = store;
            document.getElementById('oTotal').innerText = total;
            document.getElementById('oDate').innerText = date;
            document.getElementById('oStatus').innerText = status;
            document.getElementById('oDeliveryStatus').innerText = deliveryStatus;

            orderModal.classList.remove('hidden');
            orderModal.classList.add('flex');
        }

        function closeOrderModal() {
            orderModal.classList.add('hidden');
            orderModal.classList.remove('flex');
        }

        // Logout handler
        function logout() {
            window.location.href = '../index.html';
        }

        // ===== STORE MANAGEMENT FUNCTIONS =====

        // Initialize favorites from localStorage
        document.addEventListener('DOMContentLoaded', () => {
            const favorites = JSON.parse(localStorage.getItem('favoriteStores') || '[]');
            favorites.forEach(storeId => {
                const btn = document.querySelector(`.favorite-btn[data-store-id="${storeId}"]`);
                if (btn) {
                    btn.classList.add('favorited');
                    btn.querySelector('.favorite-icon').style.fill = 'currentColor';
                    btn.querySelector('.favorite-icon').classList.add('text-red-500');
                    btn.querySelector('.favorite-icon').classList.remove('text-gray-400');
                    
                    const card = document.querySelector(`.store-card[data-store-id="${storeId}"]`);
                    if (card) {
                        card.dataset.category = 'all favorites';
                    }
                }
            });
        });

        // Toggle favorite for a store
        function toggleFavorite(event, storeName, storeId) {
            event.stopPropagation();
            
            const btn = event.currentTarget;
            const icon = btn.querySelector('.favorite-icon');
            const card = document.querySelector(`.store-card[data-store-id="${storeId}"]`);
            
            let favorites = JSON.parse(localStorage.getItem('favoriteStores') || '[]');
            
            if (btn.classList.contains('favorited')) {
                btn.classList.remove('favorited');
                icon.style.fill = 'none';
                icon.classList.remove('text-red-500');
                icon.classList.add('text-gray-400');
                
                favorites = favorites.filter(id => id !== storeId);
                card.dataset.category = 'all';
            } else {
                btn.classList.add('favorited');
                icon.style.fill = 'currentColor';
                icon.classList.add('text-red-500');
                icon.classList.remove('text-gray-400');
                
                if (!favorites.includes(storeId)) {
                    favorites.push(storeId);
                }
                
                card.dataset.category = 'all favorites';
            }
            
            localStorage.setItem('favoriteStores', JSON.stringify(favorites));
        }

        // Search stores
        function searchStores(query) {
            const storeCards = document.querySelectorAll('.store-card');
            const searchTerm = query.toLowerCase();

            storeCards.forEach(card => {
                const storeName = card.querySelector('h3').textContent.toLowerCase();
                const description = card.querySelector('p').textContent.toLowerCase();
                
                if (storeName.includes(searchTerm) || description.includes(searchTerm) || searchTerm === '') {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Filter stores
        function filterStores(category) {
            const storeCards = document.querySelectorAll('.store-card');
            const filterButtons = document.querySelectorAll('.filter-btn');

            // Update button styles
            filterButtons.forEach(btn => {
                if (btn.dataset.category === category) {
                    btn.classList.remove('bg-slate-100', 'text-slate-700');
                    btn.classList.add('bg-blue-600', 'text-white');
                } else {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-slate-100', 'text-slate-700');
                }
            });

            // Filter stores
            storeCards.forEach(card => {
                if (category === 'all') {
                    card.style.display = 'block';
                } else if (category === 'favorites') {
                    const isFavorited = card.querySelector('.favorite-btn.favorited');
                    card.style.display = isFavorited ? 'block' : 'none';
                }
            });
        }

        // Open Store Modal
        function openStoreModal(storeName, storeType, rating, deliveryTime, deliveryFee, minOrder) {
            const modalHTML = `
                <div id="storeModal" class="fixed inset-0 modal-bg z-50 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl w-full max-w-2xl max-h-96 overflow-y-auto">
                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 flex justify-between items-start sticky top-0">
                            <div>
                                <h2 class="text-3xl font-bold">${storeName}</h2>
                                <p class="text-blue-100 mt-1">${storeType}</p>
                                <div class="mt-3 flex gap-4 text-sm">
                                    <span class="bg-white text-blue-600 px-3 py-1 rounded-full font-semibold">‚≠ê ${rating}</span>
                                    <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full">üì¶ ${deliveryTime}</span>
                                    <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full">üöö ${deliveryFee}</span>
                                </div>
                            </div>
                            <button onclick="closeStoreModal()" class="text-white hover:bg-blue-700 p-2 rounded-lg">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>

                        <div class="p-6">
                            <div class="mb-6">
                                <h3 class="font-bold text-lg mb-3">Popular Items</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center p-3 bg-slate-50 rounded-lg hover:bg-blue-50 transition cursor-pointer">
                                        <span class="font-semibold">Signature Dish</span>
                                        <span class="text-blue-600 font-bold">‚Ç±299</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-slate-50 rounded-lg hover:bg-blue-50 transition cursor-pointer">
                                        <span class="font-semibold">Classic Combo</span>
                                        <span class="text-blue-600 font-bold">‚Ç±449</span>
                                    </div>
                                    <div class="flex justify-between items-center p-3 bg-slate-50 rounded-lg hover:bg-blue-50 transition cursor-pointer">
                                        <span class="font-semibold">Premium Selection</span>
                                        <span class="text-blue-600 font-bold">‚Ç±599</span>
                                    </div>
                                </div>
                            </div>

                            <div class="border-t pt-4">
                                <h3 class="font-bold text-lg mb-3">Store Info</h3>
                                <div class="space-y-2 text-sm text-slate-600">
                                    <p><strong>Minimum Order:</strong> ${minOrder}</p>
                                    <p><strong>Delivery Time:</strong> ${deliveryTime}</p>
                                    <p><strong>Delivery Fee:</strong> ${deliveryFee}</p>
                                    <p><strong>Rating:</strong> ${rating} ‚≠ê</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-50 p-6 border-t flex gap-3 sticky bottom-0">
                            <button onclick="closeStoreModal()" class="flex-1 bg-slate-200 hover:bg-slate-300 text-slate-800 font-bold py-3 rounded-lg transition">Close</button>
                            <button class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">Browse Menu</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function closeStoreModal() {
            const modal = document.getElementById('storeModal');
            if (modal) {
                modal.remove();
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('storeModal');
            if (modal && e.target === modal) {
                closeStoreModal();
            }
        });

        // ===== ORDER MANAGEMENT FUNCTIONS =====

        // Navigate to a specific store
        function switchStore(storeName) {
            switchTab('stores');
        }

        // Open delivery timeline modal
        function openDeliveryTimeline(status, currentStatus, orderId) {
            const timelineSteps = [
                { name: 'Order Placed', icon: '‚úì', completed: true },
                { name: 'Order Ready for Pickup', icon: 'üì¶', completed: currentStatus !== 'Order Placed' && currentStatus !== 'Pending' },
                { name: 'Picked Up by Rider', icon: 'üèçÔ∏è', completed: currentStatus === 'In Delivery' || currentStatus === 'Delivered' },
                { name: 'In Transit', icon: 'üöö', completed: currentStatus === 'Delivered' },
                { name: 'Delivered', icon: '‚úì', completed: currentStatus === 'Delivered' }
            ];

            let timelineHTML = `
                <div id="timelineModal" class="fixed inset-0 modal-bg z-50 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl w-full max-w-2xl shadow-2xl">
                        <div class="p-6 border-b flex justify-between items-center">
                            <div>
                                <h3 class="text-2xl font-bold">Order Journey</h3>
                                <p class="text-sm text-slate-500 mt-1">Order #${orderId}</p>
                            </div>
                            <button onclick="closeTimelineModal()" class="p-2 hover:bg-gray-100 rounded-full">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>
                        
                        <div class="p-8">
                            <div class="space-y-6">
            `;

            timelineSteps.forEach((step, index) => {
                const isLast = index === timelineSteps.length - 1;
                timelineHTML += `
                    <div class="flex gap-4">
                        <div class="flex flex-col items-center">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${
                                step.completed ? 'bg-green-100 text-green-700' : 'bg-slate-100 text-slate-400'
                            }">
                                ${step.icon}
                            </div>
                            ${!isLast ? '<div class="w-1 h-12 bg-slate-200 mt-2"></div>' : ''}
                        </div>
                        <div class="pt-2">
                            <p class="font-semibold text-lg ${
                                step.completed ? 'text-slate-900' : 'text-slate-400'
                            }">${step.name}</p>
                            <p class="text-sm text-slate-500 mt-1">${
                                step.completed ? 'Completed' : 'Pending'
                            }</p>
                        </div>
                    </div>
                `;
            });

            timelineHTML += `
                            </div>
                        </div>
                        
                        <div class="bg-slate-50 p-6 border-t flex gap-3">
                            <button onclick="closeTimelineModal()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">Close</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', timelineHTML);
        }

        function closeTimelineModal() {
            const modal = document.getElementById('timelineModal');
            if (modal) modal.remove();
        }

        // Open product detail modal
        function openProductDetail(productName, price, quantity, description) {
            const modalHTML = `
                <div id="productModal" class="fixed inset-0 modal-bg z-50 flex items-center justify-center p-4">
                    <div class="bg-white rounded-3xl w-full max-w-2xl shadow-2xl">
                        <div class="p-6 border-b flex justify-between items-center">
                            <h3 class="text-2xl font-bold">${productName}</h3>
                            <button onclick="closeProductModal()" class="p-2 hover:bg-gray-100 rounded-full">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>
                        
                        <div class="p-6 space-y-6">
                            <img src="https://via.placeholder.com/400?text=${productName}" alt="${productName}" class="w-full h-64 rounded-2xl object-cover">
                            
                            <div>
                                <h4 class="text-sm font-semibold text-slate-500 uppercase mb-2">Description</h4>
                                <p class="text-lg text-slate-700">${description}</p>
                            </div>
                            
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <p class="text-sm text-slate-500">Quantity Ordered</p>
                                    <p class="text-2xl font-bold text-blue-600 mt-1">${quantity}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-slate-500">Unit Price</p>
                                    <p class="text-2xl font-bold text-blue-600 mt-1">${price}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-slate-500">Total</p>
                                    <p class="text-2xl font-bold text-green-600 mt-1" id="totalPrice"></p>
                                </div>
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-xl">
                                <h4 class="font-semibold text-slate-700 mb-3">Order Again?</h4>
                                <p class="text-sm text-slate-600 mb-4">Add this item to your cart from the store menu</p>
                                <button onclick="switchTab('stores'); closeProductModal();" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition">Go to Store</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Calculate total price
            const priceValue = parseFloat(price.replace('$', ''));
            const total = (priceValue * quantity).toFixed(2);
            document.getElementById('totalPrice').textContent = '$' + total;
        }

        function closeProductModal() {
            const modal = document.getElementById('productModal');
            if (modal) modal.remove();
        }

        // ===== Simple Conversations / Chat UI =====
        const conversations = [
            { id: 1, name: 'Bes Burger House', last: 'Your order is being prepared...', messages: [
                { from: 'them', text: 'Your order is being prepared...', time: Date.now() - 60000 },
                { from: 'me', text: 'Thanks! ETA?', time: Date.now() - 30000 }
            ] },
            { id: 2, name: 'Pizza Palace', last: 'Your pizza is out for delivery', messages: [
                { from: 'them', text: 'Your pizza is out for delivery', time: Date.now() - 120000 }
            ] },
            { id: 3, name: 'Cafe Blend', last: 'We received your order', messages: [
                { from: 'them', text: 'We received your order', time: Date.now() - 360000 }
            ] }
        ];

        let activeConversationId = null;

        function renderConversationsList(list = conversations) {
            const ul = document.getElementById('convoList');
            ul.innerHTML = '';
            list.forEach(conv => {
                const li = document.createElement('li');
                li.className = 'p-3 rounded-lg hover:bg-slate-50 cursor-pointer flex justify-between items-start';
                li.innerHTML = `
                    <div>
                        <div class="font-semibold">${conv.name}</div>
                        <div class="text-xs text-slate-500 mt-1 truncate" style="max-width:220px">${conv.messages[conv.messages.length-1]?.text || ''}</div>
                    </div>
                    <div class="text-xs text-slate-400">${formatTime(conv.messages[conv.messages.length-1]?.time)}</div>
                `;
                li.onclick = () => selectConversation(conv.id);
                ul.appendChild(li);
            });
        }

        function selectConversation(id) {
            activeConversationId = id;
            const conv = conversations.find(c => c.id === id);
            document.getElementById('chatWith').innerText = conv.name;
            renderChatWindow(conv);
        }

        function renderChatWindow(conv) {
            const win = document.getElementById('chatWindow');
            win.innerHTML = '';
            conv.messages.forEach(m => {
                const p = document.createElement('div');
                p.className = (m.from === 'me') ? 'text-right mb-2' : 'text-left mb-2';
                p.innerHTML = `<div class="inline-block px-3 py-2 rounded-xl ${m.from === 'me' ? 'bg-blue-600 text-white' : 'bg-white text-slate-800 border'}">${m.text}</div>`;
                win.appendChild(p);
            });
            win.scrollTop = win.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text || activeConversationId === null) return;
            const conv = conversations.find(c => c.id === activeConversationId);
            const msg = { from: 'me', text, time: Date.now() };
            conv.messages.push(msg);
            conv.last = text;
            input.value = '';
            renderChatWindow(conv);
            renderConversationsList();
        }

        function searchConversations(query) {
            const q = (query || '').toLowerCase();
            if (!q) return renderConversationsList(conversations);
            const filtered = conversations.filter(c => c.name.toLowerCase().includes(q) || (c.last || '').toLowerCase().includes(q));
            renderConversationsList(filtered);
        }

        function formatTime(ts) {
            if (!ts) return '';
            const d = new Date(ts);
            return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        // Initialize conversation list on load
        document.addEventListener('DOMContentLoaded', () => {
            renderConversationsList();
        });
    </script>
</body>
</html>
